
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://github.com/citiwatts/wiki/developers-section/">
      
      
        <link rel="prev" href="../how-to-edit-this-wiki/">
      
      
        <link rel="next" href="../api/">
      
      
      <link rel="icon" href="https://raw.githubusercontent.com/citiwatts/wiki/refs/heads/main/assets/logo-mini.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>Develop CMs - Citiwatts Wiki</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Ubuntu";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-calculation-modules" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Citiwatts Wiki" class="md-header__button md-logo" aria-label="Citiwatts Wiki" data-md-component="logo">
      
  <img src="https://raw.githubusercontent.com/citiwatts/wiki/refs/heads/main/assets/logo-mini.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Citiwatts Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Develop CMs
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/citiwatts/wiki/wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Citiwatts Wiki" class="md-nav__button md-logo" aria-label="Citiwatts Wiki" data-md-component="logo">
      
  <img src="https://raw.githubusercontent.com/citiwatts/wiki/refs/heads/main/assets/logo-mini.png" alt="logo">

    </a>
    Citiwatts Wiki
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/citiwatts/wiki/wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Wiki Introduction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Wiki Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../about-the-citiwatts-toolbox/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About the Citiwatts Toolbox
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    General Functionalities & Structure
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            General Functionalities & Structure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-to-user-interface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction To User Interface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-account-registration-log-in-personal-layer-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Account (Registration, Log-In, Personal Layer Management)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../layer-section-in-the-citiwatts-toolbox/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Layer Section In The Citiwatts Toolbox
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../select-a-region-in-the-citiwatts-toolbox/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Select A Region In The Citiwatts Toolbox
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../retrieve-indicators-of-a-selected-area/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Retrieve Indicators Of A Selected Area
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../access-to-calculation-modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Access To Calculation Modules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database-behind-the-citiwatts-toolbox/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Database Behind The Citiwatts Toolbox
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-upload-functionalities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Upload Functionalities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-export-functionalities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Export Functionalities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../platform-release-notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Platform release notes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Datasets / Layers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Datasets / Layers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../methodology-of-data-collection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Methodology Of Data Collection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../open-data-repository/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Open Data Repository
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Calculation Modules (CMs)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Calculation Modules (CMs)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Heat Calculation Modules (CMs)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Heat Calculation Modules (CMs)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../heat-cm-customized-heat-and-gross-floor-area-density-maps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heat CM: Customized Heat And Gross Floor Area Density Maps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../heat-cm-scale-heat-and-cool-density-maps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heat CM: Scale Heat And Cool Density Maps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../heat-cm-demand-projection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heat CM: Demand Projection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../heat-cm-heat-load-profiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heat CM: Heat Load Profiles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../heat-cm-district-heating-potential-areas-user-defined-thresholds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heat CM: District Heating Potential Areas: User-Defined Thresholds
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../heat-cm-district-heating-potential-economic-assessment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heat CM: District Heating Potential: Economic Assessment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../heat-cm-district-heating-potential-economic-assessment--with-temperature-levels/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heat CM: District Heating Potential: Economic Assessment - With Temperature Levels
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../heat-cm-district-heating-supply/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heat CM: District Heating Supply
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../heat-cm-decentral-heating-supply/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heat CM: Decentral Heating Supply
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cooling Calculation Modules (CMs)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Cooling Calculation Modules (CMs)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cooling-cm-district-cooling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cooling CM: District Cooling
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Energy Sources Calculation Modules (CMs)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Energy Sources Calculation Modules (CMs)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy-sources-cm-solar-thermal-and-pv-potential/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Energy Sources CM: Solar Thermal And PV Potential
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy-sources-cm-shallow-geothermal-potential/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Energy Sources CM: Shallow Geothermal Potential
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy-sources-cm-heat-source-potential/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Energy Sources CM: Heat Source Potential
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy-sources-cm-biomass-potential/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Energy Sources CM: Biomass Potential
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy-sources-cm-wind-potential/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Energy Sources CM: Wind Potential
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy-sources-cm-excess-heat-transport-potential/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Energy Sources CM: Excess Heat Transport Potential
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Industry Calculation Modules (CMs)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Industry Calculation Modules (CMs)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../industry-cm-add-industry-plant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Industry CM: Add Industry Plant
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Mobility Calculation Modules (CMs)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Mobility Calculation Modules (CMs)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mobility-cm-electric-vehicle-density/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mobility CM: Electric Vehicle Density
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mobility-cm-electric-vehicles-charging-needs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mobility CM: Electric Vehicles Charging Needs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Energy System Calculation Modules (CMs)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Energy System Calculation Modules (CMs)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../energy-system-cm-energyplan-cm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Energy System CM: EnergyPLAN CM
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Learning Center
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Learning Center
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../learning-toolchain-approach/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Toolchain Approach: Conducting Scenario Assessments in the citiwatts platform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    eLearning, Webinars and Training Materials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            eLearning, Webinars and Training Materials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../learning-heat-planning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    I: Heat Planning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../learning-cool-planning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    II: Cool Planning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../learning-ev-mobility-scenarios/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    III: Electric Vehicle Scenarios
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../learning-energyplan-cm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IV: Energy System Analysis and Flexibility (EnergyPLAN CM)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../case-study-reports/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Case Study Reports
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    For Developers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            For Developers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-edit-this-wiki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How To Edit This Wiki
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Develop CMs
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Develop CMs
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-calculation-modules" class="md-nav__link">
    <span class="md-ellipsis">
      1. Calculation Modules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      2. Getting Started
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Getting Started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-visualizationtool-locally" class="md-nav__link">
    <span class="md-ellipsis">
      Run VisualizationTool locally
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-a-new-cm" class="md-nav__link">
    <span class="md-ellipsis">
      Adding a new CM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visual-checkpoint-what-you-should-see" class="md-nav__link">
    <span class="md-ellipsis">
      Visual Checkpoint: What You Should See
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-working-on-your-cm" class="md-nav__link">
    <span class="md-ellipsis">
      Start working on your CM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Start working on your CM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#change-the-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      Change the inputs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modify-the-calculation-logic" class="md-nav__link">
    <span class="md-ellipsis">
      Modify the calculation logic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-the-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      Change the outputs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-the-tests-for-the-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Update the tests for the pipeline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git-and-version-control" class="md-nav__link">
    <span class="md-ellipsis">
      Git and version control
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      3. Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#important-files-for-cm-development" class="md-nav__link">
    <span class="md-ellipsis">
      Important files for CM development:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-structure" class="md-nav__link">
    <span class="md-ellipsis">
      File structure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-signature-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      4. Signature &amp; Inputs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Signature &amp; Inputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#signature-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Signature Fields:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#41-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Inputs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.1 Inputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Input Fields:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#42-layer-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Layer Inputs:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.2 Layer Inputs:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#layer-input-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Layer Input Fields:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-1-heat-demand-density-layer-raster" class="md-nav__link">
    <span class="md-ellipsis">
      Example 1: Heat demand density layer (raster)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-motorization-rate-layer-vector" class="md-nav__link">
    <span class="md-ellipsis">
      Example 2: Motorization rate layer (vector)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#43-dynamic-inputs-beta" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Dynamic Inputs (beta)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.3 Dynamic Inputs (beta)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamic-input-array" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Input Array
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dynamic Input Array">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamic-input-array-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Input Array Fields:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-input-options" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Input Options
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dynamic Input Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamic-input-options-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Input Options Fields:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      5. Outputs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Outputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#name" class="md-nav__link">
    <span class="md-ellipsis">
      name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indicator" class="md-nav__link">
    <span class="md-ellipsis">
      indicator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphics" class="md-nav__link">
    <span class="md-ellipsis">
      graphics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vector_layers" class="md-nav__link">
    <span class="md-ellipsis">
      vector_layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raster_layers" class="md-nav__link">
    <span class="md-ellipsis">
      raster_layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extra_zip_files" class="md-nav__link">
    <span class="md-ellipsis">
      extra_zip_files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#csv_files" class="md-nav__link">
    <span class="md-ellipsis">
      csv_files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-logs" class="md-nav__link">
    <span class="md-ellipsis">
      6. Logs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Logs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#access-logs-from-local-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Access Logs from local machine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-logs-from-development-and-production" class="md-nav__link">
    <span class="md-ellipsis">
      Access Logs from development and production
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-tests" class="md-nav__link">
    <span class="md-ellipsis">
      7. Tests
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reminder" class="md-nav__link">
    <span class="md-ellipsis">
      Reminder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writing-unit-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Writing Unit Tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enhance-unit-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Enhance Unit Tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cover-different-scenarios" class="md-nav__link">
    <span class="md-ellipsis">
      Cover different scenarios
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-unit-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Run Unit Tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Automated testing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-cite" class="md-nav__link">
    <span class="md-ellipsis">
      How To Cite
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authors-and-reviewers" class="md-nav__link">
    <span class="md-ellipsis">
      Authors And Reviewers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    <span class="md-ellipsis">
      License
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acknowledgement" class="md-nav__link">
    <span class="md-ellipsis">
      Acknowledgement
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../layers-available/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Layers Available
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../example-of-charts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Example of charts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-calculation-modules" class="md-nav__link">
    <span class="md-ellipsis">
      1. Calculation Modules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      2. Getting Started
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Getting Started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-visualizationtool-locally" class="md-nav__link">
    <span class="md-ellipsis">
      Run VisualizationTool locally
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-a-new-cm" class="md-nav__link">
    <span class="md-ellipsis">
      Adding a new CM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visual-checkpoint-what-you-should-see" class="md-nav__link">
    <span class="md-ellipsis">
      Visual Checkpoint: What You Should See
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-working-on-your-cm" class="md-nav__link">
    <span class="md-ellipsis">
      Start working on your CM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Start working on your CM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#change-the-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      Change the inputs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modify-the-calculation-logic" class="md-nav__link">
    <span class="md-ellipsis">
      Modify the calculation logic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-the-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      Change the outputs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-the-tests-for-the-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Update the tests for the pipeline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git-and-version-control" class="md-nav__link">
    <span class="md-ellipsis">
      Git and version control
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      3. Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#important-files-for-cm-development" class="md-nav__link">
    <span class="md-ellipsis">
      Important files for CM development:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-structure" class="md-nav__link">
    <span class="md-ellipsis">
      File structure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-signature-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      4. Signature &amp; Inputs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Signature &amp; Inputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#signature-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Signature Fields:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#41-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Inputs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.1 Inputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Input Fields:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#42-layer-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Layer Inputs:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.2 Layer Inputs:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#layer-input-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Layer Input Fields:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-1-heat-demand-density-layer-raster" class="md-nav__link">
    <span class="md-ellipsis">
      Example 1: Heat demand density layer (raster)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-motorization-rate-layer-vector" class="md-nav__link">
    <span class="md-ellipsis">
      Example 2: Motorization rate layer (vector)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#43-dynamic-inputs-beta" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Dynamic Inputs (beta)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.3 Dynamic Inputs (beta)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamic-input-array" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Input Array
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dynamic Input Array">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamic-input-array-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Input Array Fields:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-input-options" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Input Options
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dynamic Input Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamic-input-options-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Input Options Fields:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      5. Outputs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Outputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#name" class="md-nav__link">
    <span class="md-ellipsis">
      name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indicator" class="md-nav__link">
    <span class="md-ellipsis">
      indicator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphics" class="md-nav__link">
    <span class="md-ellipsis">
      graphics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vector_layers" class="md-nav__link">
    <span class="md-ellipsis">
      vector_layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raster_layers" class="md-nav__link">
    <span class="md-ellipsis">
      raster_layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extra_zip_files" class="md-nav__link">
    <span class="md-ellipsis">
      extra_zip_files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#csv_files" class="md-nav__link">
    <span class="md-ellipsis">
      csv_files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-logs" class="md-nav__link">
    <span class="md-ellipsis">
      6. Logs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Logs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#access-logs-from-local-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Access Logs from local machine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-logs-from-development-and-production" class="md-nav__link">
    <span class="md-ellipsis">
      Access Logs from development and production
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-tests" class="md-nav__link">
    <span class="md-ellipsis">
      7. Tests
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reminder" class="md-nav__link">
    <span class="md-ellipsis">
      Reminder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writing-unit-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Writing Unit Tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enhance-unit-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Enhance Unit Tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cover-different-scenarios" class="md-nav__link">
    <span class="md-ellipsis">
      Cover different scenarios
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-unit-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Run Unit Tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Automated testing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-cite" class="md-nav__link">
    <span class="md-ellipsis">
      How To Cite
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authors-and-reviewers" class="md-nav__link">
    <span class="md-ellipsis">
      Authors And Reviewers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    <span class="md-ellipsis">
      License
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acknowledgement" class="md-nav__link">
    <span class="md-ellipsis">
      Acknowledgement
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/citiwatts/wiki/wiki/developers-section/_edit" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


  <h1 id="top">Develop CMs</h1>

<h2 id="1-calculation-modules">1. Calculation Modules</h2>
<p>A Calculation Module is a plug-in application that expends the Visualization Tool. They are used to perform calculations on georeferenced data.<br />
In this documentation, we refer to a Calculation Module as a <strong>CM</strong>. List of existing calculation module can be found on the main <a href="https://vlhtuleap.hevs.ch/plugins/git/git-eranet/Visualization_tool">Readme</a></p>
<p>This documentation is meant for the CM developers, who write the calculation logic.</p>
<p><strong><a href="#top">Go To Top</a></strong></p>
<h2 id="2-getting-started">2. Getting Started</h2>
<h3 id="run-visualizationtool-locally">Run VisualizationTool locally</h3>
<p>CMs have no graphical user interface (GUI). CMs are meant to be used via the Visualization Tool (citiwatts, COOLlife, Openmod4africa).<br />
Meaning, to work on the development of a CM, the Visualization Tool is needed for testing.</p>
<p>Follow the steps from the main <a href="https://vlhtuleap.hevs.ch/plugins/git/git-eranet/Visualization_tool">Readme</a> to run it locally on your machine.</p>
<p>To access to the logs, see chapter <a href="#6-logs">logs</a></p>
<h3 id="adding-a-new-cm">Adding a new CM</h3>
<ol>
<li>Contact <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#99;&#105;&#116;&#105;&#119;&#97;&#116;&#116;&#115;&#64;&#104;&#101;&#118;&#115;&#46;&#99;&#104;">&#99;&#105;&#116;&#105;&#119;&#97;&#116;&#116;&#115;&#64;&#104;&#101;&#118;&#115;&#46;&#99;&#104;</a> to create a new git for your CM. Please specify a name, a repo name (no space, lower case) and which <a href="https://vlhtuleap.hevs.ch">vlhtuleap</a> accounts need access to it.</li>
<li>HEVS team will duplicate base_calculation module, and adapt configuration to display it on <a href="https://citiwattsdev.hevs.ch/map">citiwattsdev.hevs.ch</a></li>
<li>
<p>After validation le HEVS team, run in your Visualization_tool folder:</p>
<p><code>sh
$ (sudo) git submodule update --init --recursive</code></p>
<p>or Go in calculation_modules folder and run</p>
<p><code>sh
(sudo) git clone &lt;git_link_of_your_cm&gt;</code></p>
<p>All link of CM can be found on the main <a href="https://vlhtuleap.hevs.ch/plugins/git/git-eranet/Visualization_tool">Readme</a></p>
</li>
</ol>
<h3 id="visual-checkpoint-what-you-should-see">Visual Checkpoint: What You Should See</h3>
<p>At this point, you should verify that your local development environment is running correctly.</p>
<p>Open Docker Desktop: You should see running containers for the Visualization Tool and its components:<br />
<img alt="image" src="https://github.com/user-attachments/assets/772eeead-951b-4fef-8acc-363f3a97d7e0" /></p>
<p>Open your browser to <a href="http://localhost:4200">http://localhost:4200</a> : The Visualization Tool UI should load.</p>
<p>Navigate to the layer/CM list: Your newly added CM should be visible as an option:<br />
<img alt="image" src="https://github.com/user-attachments/assets/34f73e1a-d1ec-4bc0-b08a-da0b302e3d67" /></p>
<h3 id="start-working-on-your-cm">Start working on your CM</h3>
<p>All new CMs are based on the Scale heat and cool density maps, also known as the Base CM. The Base CM has two purpose:
1. An actual CM, it takes a heat demand layer and a multiplication factor, and it returns a heat demand layer multiplied by the factor
2. A basic and documented example to help in the development of other CMs</p>
<h4 id="change-the-inputs">Change the inputs</h4>
<p>Since your CM starts as a duplicate of the Base CM, the first element you will want to change is the inputs. See the chapter <a href="#4-signature--inputs">Signature &amp; Inputs</a> to learn what type of inputs are available and how to change them. 
After modifying the code of the CM, save the files and restart the dockers as explained in the VisualizationTool README.</p>
<h4 id="modify-the-calculation-logic">Modify the calculation logic</h4>
<p>The calculation happens in <code>calculation_modules\base_calculation_module\cm\app\api_v1\calculation_module.py</code> in the <code>def calculation()</code> method. 
See the Base CM, or your own CM documentation, for a detailed documentation of the process. No other files in the CMs should be modified to implement the calculation logic.  </p>
<p>If you need additional files, or if you wish to split the logic into dedicated functions in dedicated files, you can add them to the <code>calculation_modules\base_calculation_module\cm\app\api_v1\my_calculation_module_directory</code> folder.  </p>
<p>For the generation of layers that will be returned by the CM, you will find helper functions in the <code>calculation_modules\base_calculation_module\cm\app\helper.py</code> file.</p>
<h4 id="change-the-outputs">Change the outputs</h4>
<p>The outputs are all the information that the CM will return to the VisualizationTool. Those can be key-values (indicators), csv and zip files, and all the layers to be displayed. The outputs are returned by the <code>return</code> statement of the <code>def calculation()</code> method. 
See the chapter <a href="#5-outputs">Outputs</a> for more informations on what data can be returned as output and how to format them.</p>
<h4 id="update-the-tests-for-the-pipeline">Update the tests for the pipeline</h4>
<p>Unit testing is used to ensure code quality in the CM, and to avoid regression during development. Tests must be set-up and kept up-to-date for the CM to be accepted for development and production deployment.<br />
See the chapter <a href="#8-tests">Tests</a> for more informations on what data can be returned as output and how to format them.</p>
<h4 id="git-and-version-control">Git and version control</h4>
<p>The <code>main</code> branch is managed by the HES-SO, so all development work should be done on the <code>develop</code> branch, or parallel branches that get merged into develop.</p>
<p><strong><a href="#top">Go To Top</a></strong></p>
<h2 id="3-architecture">3. Architecture</h2>
<p><img alt="image" src="https://github.com/user-attachments/assets/680bad6d-9d0c-4786-b0ff-bcb1671f096b" /></p>
<p>CMs are <code>Python</code> applications built with <code>Flask</code>. They run in a docker container and they extends the functionalities of the Visualization Tool.
CMs are run in docker containers and they communicate with the Visualisation Tool backend via a docker network. Once a CM is started, it will automatically register itself to the Backend (API). After that, the CM wait for calls to perform their computation. Those calls start from the Frontend, go the the Backend(API) and are transmitted to the CM via the intermediary of tasks and queues manager (RabbitMQ, Redis and Flower).</p>
<p>Most of the files in a CM are there to ensure the auto-registration and the proper interactions between the CM and the rest of the Visualization Tool project. The following sequence is the relevant part for CM development:</p>
<ol>
<li>CM registers to backen and is identified with the SIGNATURE</li>
<li>A CM takes in inputs, mostly georeferenced data (or layers) and more. More details in the <a href="#4-signature-and-inputs">signature and inputs</a>.</li>
<li>Then it performs a calculation based on those data.</li>
<li>And finally, it <a href="#5-outputs">outputs</a> the new data so that it can be displayed in the frontend of the Visualization Tool.</li>
</ol>
<h3 id="important-files-for-cm-development">Important files for CM development:</h3>
<ul>
<li>
<p><strong>calculation_module.py:</strong>
  Contains the <code>calculation()</code> method. <code>calculation()</code> is called when the CM is run. It is in the body of this method that the calculation happens. You have to define the <a href="#5-outputs">outputs</a> inside.
   Path: <code>cm/app/api_v1/calculation_module.py</code></p>
</li>
<li>
<p><strong>my_calculation_module_directory:</strong>
  All additional files needed for running the calculation module must be added in this directory.
  Path: <code>cm/app/api_v1/my_calculation_module_directory</code></p>
</li>
<li>
<p><strong>transactions.py:</strong>
  Contains all the routes used for communication between the CM and the Visualization Tool backend. Normally you don't need to edit this file.
  Path: <code>cm/app/api_v1/transactions.py</code></p>
</li>
<li>
<p><strong>constant.py:</strong>
  Contains the constants used by the CM that defines all the inputs used to call the CM. More details in the <a href="#4-signature-and-inputs">signature and inputs</a><br />
  Path: <code>cm/app/constant.py</code></p>
</li>
</ul>
<h3 id="file-structure">File structure</h3>
<p>The <code>base_calculation_module</code> is a simple CM, used as the base for all other CMs.<br />
Known as the "CM - Scale heat and cool density maps" in the Visualizatin Tool, it takes a layer of type heat and a multiplication factor and returns a new layer with its data multiplied by the multiplication factor. It is available at <a href="https://vlhtuleap.hevs.ch/plugins/git/git-eranet/base_calculation_module?a=blob&amp;f=README.md&amp;hb=develop">Base CM</a>.<br />
Below is the file structure of the <code>base_calculation_module</code>:</p>
<pre><code>   .gitignore
   docker-compose.tests.yml
   Jenkinsfile
   LICENSE
   README.md

cm
       consumer_cm_alive.py
       consumer_cm_compute.py
       Dockerfile
       gunicorn-config.py
       register_cm.py
       requirements.txt
       run.py
       run_all_local_terminal.sh
       supervisord.conf
       test.py
       wait-for-it.sh
       __init__.py
    
    app
          constant.py
          exceptions.py
          helper.py
          logging.conf
          utils.py
          __init__.py
       
       api_v1
             calculation_module.py
             errors.py
             transactions.py
             __init__.py
          
          my_calculation_module_directory
                  __init__.py
       
       decorators
               caching.py
               json.py
               paginate.py
               rate_limit.py
               __init__.py
    
    config
           development.py
           production.py
           testing.py
           __init__.py
    
    tests
           tests.py
           test_client.py
           __init__.py
        
        data
                raster_for_test.tif
</code></pre>
<p><strong><a href="#top">Go To Top</a></strong></p>
<h2 id="4-signature-inputs">4. Signature &amp; Inputs</h2>
<p>The SIGNATURE is an object that contains important information about the CM, such as its name and the inputs it requires. 
It can be found in cm/app/constant.py. All fields must be included in the SIGNATURE, unless they are specified as optional.</p>
<p><code>base_calculation_module</code> example: </p>
<pre><code>INPUTS_CALCULATION_MODULE = [
    {
        &quot;input_name&quot;: &quot;Multiplication factor&quot;,
        &quot;input_type&quot;: &quot;input&quot;,
        &quot;input_description&quot;: &quot;This factor will multiply the layer values&quot;,
        &quot;input_parameter_name&quot;: &quot;multiplication_factor&quot;,
        &quot;input_value&quot;: &quot;1&quot;,
        &quot;input_priority&quot;: 0,
        &quot;input_unit&quot;: &quot;&quot;,
        &quot;input_min&quot;: 0,
        &quot;input_max&quot;: 10,
        &quot;cm_id&quot;: CM_ID,  # Do no change this value
    },
    ### Layer Inputs
    {
        &quot;input_name&quot;: &quot;Heat demand density&quot;,
        &quot;input_type&quot;: &quot;layer&quot;,
        &quot;input_description&quot;: &quot;Choose a heat demand density layer.&quot;,
        &quot;input_parameter_name&quot;: &quot;layer_to_processs&quot;,
        &quot;cm_id&quot;: CM_ID,  # Do no change this value
        &quot;input_priority&quot;: 5,
        &quot;input_value&quot;: &quot;&quot;,
        &quot;input_options_array&quot;: [
            &quot;heat_tot_curr_density&quot;,
            &quot;heat_res_curr_density&quot;,
            &quot;heat_nonres_curr_density&quot;,
            &quot;cool_tot_curr_density&quot;,
        ],  # workspacenames only
        &quot;layer_format&quot;: &quot;raster&quot;,
    },
]

SIGNATURE = {
    &quot;cm_id&quot;: CM_ID,
    &quot;cm_name&quot;: CM_NAME,
    &quot;category&quot;: &quot;Demand&quot;,
    &quot;wiki_url&quot;: &quot;https://citiwatts.github.io/wiki/heat-cm-scale-heat-and-cool-density-maps/&quot;,
    &quot;cm_url&quot;: &quot;Do not add something&quot;,
    &quot;cm_description&quot;: &quot;This calculation module allows to scale the heat demand density layer up or down.&quot;,
    &quot;authorized_scale&quot;: [
        &quot;NUTS 1&quot;,
        &quot;NUTS 2&quot;,
        &quot;NUTS 3&quot;,
        &quot;LAU 2&quot;,
        &quot;Hectare&quot;,
    ],  # if empty, allow all
    &quot;inputs_calculation_module&quot;: INPUTS_CALCULATION_MODULE,
}
</code></pre>
<h4 id="signature-fields">Signature Fields:</h4>
<ul>
<li><strong><code>cm_id</code></strong>: ID used to make the CM accessible, must not be changed. Same as CM repository name</li>
<li><strong><code>cm_name</code></strong>: name of the calculation module that will be displayed in the Frontend</li>
<li><strong><code>category</code></strong>: category of the calculation module. It is used to group CMs in the left panel of the Frontend</li>
<li><strong><code>wiki_url</code></strong>: url of the page in the wiki</li>
<li><strong><code>cm_url</code></strong>: (deprecated) must be left empty</li>
<li><strong><code>cm_description</code></strong>: description shown in the frontend, must be completed by CM developer</li>
<li><strong><code>authorized_scale</code></strong>: Array that indicates what level of region selection can be used for this CM. If the array is empty, the CM can be used without selected regions. Different scales allowed: NUTS 0, NUTS 1, NUTS 2, NUTS 3, LAU 2, Hectare. Example: "authorized_scale":["NUTS 3", "LAU 2", "Hectare"]</li>
<li><strong><code>inputs_calculation_module</code></strong>: Array of <code>input</code> objects. Contains all the user defined inputs for the same. See next section for details</li>
</ul>
<h2 id="41-inputs">4.1 Inputs</h2>
<p>CM inputs are defined in the INPUTS_CALCULATION_MODULE constant. INPUTS_CALCULATION_MODULE is an array of <code>input</code> objects. Each input object is defined as a python dict and must contain all of the following fields:</p>
<h4 id="input-fields">Input Fields:</h4>
<ul>
<li>
<p><strong><code>input_name</code></strong>: name of the input that will be displayed on the frontend GUI</p>
</li>
<li>
<p><strong><code>input_type</code></strong>: specifies the type of graphical control element that the user interacts with to provide data. The available input types are:</p>
<ul>
<li>
<p><strong>input</strong>: a single-line <strong>text box</strong> where the user can type in a value.<br />
  <img width="506" height="114" alt="image" src="https://github.com/user-attachments/assets/d7e5f324-e8cc-4267-886a-0bbec1df92df" /></p>
</li>
<li>
<p><strong>select</strong>: a <strong>drop-down menu</strong> that lets the user choose one value from a predefined list.<br />
  <img width="505" height="215" alt="image" src="https://github.com/user-attachments/assets/0ff2f60f-e1e9-4c09-b0d2-1757b1f7a4c4" /></p>
</li>
<li>
<p><strong>radio</strong>: a set of <strong>radio buttons</strong> that allow the user to select exactly one option from multiple choices.<br />
  <img width="502" height="80" alt="image" src="https://github.com/user-attachments/assets/631e19aa-d63d-481f-8339-37d93e38b742" /></p>
</li>
<li>
<p><strong>checkbox</strong>: a group of <strong>checkboxes</strong> that allow the user to select one or more options.<br />
  <img width="505" height="160" alt="image" src="https://github.com/user-attachments/assets/70b728d7-e189-48e9-8d28-557c34e8e8ec" /></p>
</li>
<li>
<p><strong>range</strong>: a <strong>slider control</strong> that allows the user to adjust a value by moving an indicator along a scale.<br />
  <img width="505" height="90" alt="image" src="https://github.com/user-attachments/assets/9e8f4e3f-af08-47e8-bd88-fd90a14a56cc" /></p>
</li>
<li>
<p><strong>datetime-local</strong>: a <strong>calendar and time picker</strong> that allows the user to select both a date and a time using a graphical interface.<br />
  <img width="498" height="90" alt="image" src="https://github.com/user-attachments/assets/d40c19e6-ff3d-4a99-b0b0-ce196f617f4d" /></p>
</li>
<li>
<p><strong>layer</strong>: a <strong>layer selector</strong> that lets the user choose a map layer, which will then be processed by the CM for calculation.<br />
  See more in <a href="#42-layer-inputs">Section 4.2: Layer Inputs</a>.<br />
  <img width="496" height="206" alt="image" src="https://github.com/user-attachments/assets/21e0df50-1e4c-4d59-bb5a-e8d98154fcc4" /></p>
</li>
</ul>
</li>
<li>
<p><strong><code>input_description</code></strong>: description put in the tooltip, can be empty<br />
  <img width="508" height="180" alt="image" src="https://github.com/user-attachments/assets/66966843-a103-4596-a5b8-f8a011fedf8c" /></p>
</li>
<li>
<p><strong><code>input_parameter_name</code></strong>: Identifier for the input, this field must be unique to the CM signature as it is used to access the input value in the CM's <code>calculation()</code> method.</p>
</li>
<li>
<p><strong><code>input_value</code></strong>: default value for the input that will be displayed on the user interface. Not applicable for <code>layer</code> type inputs. For <strong>checkbox</strong> inputs, the <code>input_value</code> can be an array.</p>
</li>
<li>
<p><strong><code>input_options_array</code></strong>: only for <strong>radio</strong>, <strong>select</strong> and <strong>checkbox</strong> inputs, array that contains all the possible options the user can choose from. The input_value must correspond to one of the item in this array.</p>
</li>
<li>
<p><strong><code>input_priority</code></strong>: this parameter allows to categorize input in the user interface. The needed value is an integer from 0 to 4:</p>
<ul>
<li>0 : Inputs, open by default</li>
<li>1 : Basic inputs, closed by default</li>
<li>2 : Advanced inputs (level 1), closed by default</li>
<li>3 : Advanced inputs (level 2), closed by default</li>
<li>4 : Advanced inputs (level 3), closed by default</li>
<li>5 : Layer inputs, open by default<br />
<img width="549" height="337" alt="image" src="https://github.com/user-attachments/assets/da183806-5b6c-45c4-a026-46dbacbf0251" /></li>
</ul>
</li>
<li>
<p><strong><code>cm_id</code></strong>: do no change this value</p>
</li>
<li>
<p><strong><code>input_unit</code></strong>: unit used for the input value</p>
</li>
<li>
<p><strong><code>input_min</code> &amp; <code>input_max</code></strong>: range of the input values needed, used to limit that minimum and maximum possible values for an input. If not applicable to the input, they can be defined as ''</p>
</li>
</ul>
<p>Find below examples of inputs:</p>
<pre><code>INPUTS_CALCULATION_MODULE = [
     {  'input_name': 'Write your input',
        'input_type': 'input',
        'input_description': 'Description of the input',
        'input_parameter_name': 'input_item_name',
        'input_value': 1,
        'input_priority': 0,
        'input_unit': '',
        'input_min': 1,
        'input_max': 10,
        'cm_id': CM_ID
      },
      { 'input_name': 'Select your input',
        'input_type': 'select',
        'input_description': 'Description of the input',
        'input_parameter_name':'input_select_name' ,
        'input_value': 'List item 1',
        'input_options_array': [&quot;List item 1&quot;,
                       &quot;List item 2&quot;,
                       &quot;List item 3&quot;,
                       &quot;List item 4&quot;],
        'input_priority': 0,
        'input_unit': '',
        'input_min': '',
        'input_max': '',
        'cm_id': CM_ID
      },
      {
        'input_name': 'Select the radio button',
        'input_type': 'radio',
        'input_description': 'Description of the input',
        'input_parameter_name': 'input_radio_name',
        'input_value': 'Yes',
        'input_options_array': ['Yes', 'No'],
        'input_priority': 0,
        'input_unit': '',
        'input_min': '',
        'input_max': '',
        'cm_id': CM_ID
      },
      {
        &quot;input_name&quot;: &quot;Select the checkbox&quot;,
        &quot;input_type&quot;: &quot;checkbox&quot;,
        &quot;input_description&quot;: &quot;Description of the input&quot;,
        &quot;input_parameter_name&quot;: &quot;input_checkbox_name&quot;,
        &quot;input_value&quot;: [&quot;Option1&quot;, &quot;Option2&quot;],
        &quot;input_options_array&quot;: [&quot;Option1&quot;, &quot;Option2&quot;, &quot;Option3&quot;, &quot;Option4&quot;],
        &quot;input_priority&quot;: 0,
        &quot;input_unit&quot;: &quot;&quot;,
        &quot;input_min&quot;: &quot;&quot;,
        &quot;input_max&quot;: &quot;&quot;,
        &quot;cm_id&quot;: CM_ID,
      },
      {
         'input_name': 'Move the slider to select your value',
         'input_type': 'range',
         'input_parameter_name': 'input_range_name',
         'input_value': 23.5, 
         'input_priority': 0,
         'input_unit': '%' + ' of area',
         'input_min': 0,
         'input_max': 100,
         'cm_id': CM_ID
      },
]
</code></pre>
<h2 id="42-layer-inputs">4.2 Layer Inputs:</h2>
<p>Layer inputs are a special type of input field designed for selecting geospatial layers that the Calculation Module (CM) will use in its computation.<br />
When a user selects a layer, the CM receives the data <strong>clipped to the users selected area</strong>, ensuring that only the relevant portion of the dataset is processed inside the <code>calculation()</code> method.  </p>
<h4 id="layer-input-fields">Layer Input Fields:</h4>
<ul>
<li><strong><code>input_name</code></strong>: name of the input that will be displayed on the frontend GUI.  </li>
<li><strong><code>input_type</code></strong>: must be set to <code>"layer"</code>.  </li>
<li><strong><code>input_description</code></strong>: a description displayed as a tooltip in the user interface.  </li>
<li><strong><code>input_parameter_name</code></strong>: unique identifier for the input, used to access the layer in the CMs <code>calculation()</code> method.  </li>
<li>In the <code>calculation()</code> method, the value of <code>input_parameter_name</code> is a <strong>dict</strong> containing the keys <code>"path"</code> and <code>"workspacename"</code>.  </li>
<li>Example usage:<br />
<code>python
    input_raster_selection_path = inputs_raster_selection["layer_to_process"]["path"]
    input_raster_selection_workspacename = inputs_raster_selection["layer_to_process"]["workspacename"]</code></li>
<li>See the <code>base_calculation_module</code> <code>calculation()</code> method for usage example <code>calculation_modules\base_calculation_module\cm\app\api_v1\calculation_module.py</code></li>
<li><strong><code>cm_id</code></strong>: do not change this value.  </li>
<li><strong><code>input_priority</code></strong>: preferably set to <code>5</code> for layer inputs. This ensures that the input is categorized correctly in the GUI.  </li>
<li><strong><code>input_value</code></strong>: not applicable for layer inputs (set to <code>""</code>). The default value is the first option specified in <code>input_options_array</code>.</li>
<li><strong><code>input_options_array</code></strong>: array of valid <strong>workspacenames</strong> that can be selected as the layer source.  </li>
<li>List of layers with their workspacename can be found at <a href="https://citiwatts.github.io/wiki/layers-available/">https://citiwatts.github.io/wiki/layers-available/</a> </li>
<li><strong><code>layer_format</code></strong>: specifies whether the selected layer is a <code>"raster"</code> or <code>"vector"</code>.  </li>
</ul>
<hr />
<h3 id="example-1-heat-demand-density-layer-raster">Example 1: Heat demand density layer (raster)</h3>
<pre><code class="language-python">{
    &quot;input_name&quot;: &quot;Heat demand density&quot;,
    &quot;input_type&quot;: &quot;layer&quot;,
    &quot;input_description&quot;: &quot;Choose a heat demand density layer.&quot;,
    &quot;input_parameter_name&quot;: &quot;layer_to_process&quot;,
    &quot;cm_id&quot;: CM_ID,  # Do not change this value
    &quot;input_priority&quot;: 5,
    &quot;input_value&quot;: &quot;&quot;,
    &quot;input_options_array&quot;: [
        &quot;heat_tot_curr_density&quot;,
        &quot;heat_res_curr_density&quot;,
        &quot;heat_nonres_curr_density&quot;,
        &quot;cool_tot_curr_density&quot;
    ],  # workspacenames only
    &quot;layer_format&quot;: &quot;raster&quot;
}
</code></pre>
<h3 id="example-2-motorization-rate-layer-vector">Example 2: Motorization rate layer (vector)</h3>
<pre><code class="language-python">{
    &quot;input_name&quot;: &quot;Motorization rate&quot;,
    &quot;input_type&quot;: &quot;layer&quot;,
    &quot;input_description&quot;: &quot;Choose a motorization rate layer.&quot;,
    &quot;input_parameter_name&quot;: &quot;motorization_rate_nuts2_view_to_process&quot;,
    &quot;cm_id&quot;: CM_ID,  # Do not change this value
    &quot;input_priority&quot;: 5,
    &quot;input_value&quot;: &quot;&quot;,
    &quot;input_options_array&quot;: [
        &quot;motorization_rate_nuts2_view&quot;
    ],  # workspacenames only
    &quot;layer_format&quot;: &quot;vector&quot;
}
</code></pre>
<h2 id="43-dynamic-inputs-beta">4.3 Dynamic Inputs (beta)</h2>
<p>Special interactive inputs that have more functionalities than regular inputs. Dynamic Inputs are objects that can be added to the INPUTS_CALCULATION_MODULE constant.</p>
<p>For usage examples of dynamic inputs, checkout the <code>base_calculation_module</code> branch <code>demo/dynamic-inputs</code></p>
<h3 id="dynamic-input-array">Dynamic Input Array</h3>
<p>Used when a single input can occur multiple times. For example, a CM might ask for multiple coefficients or thresholds, and the user decides how many to provide (within defined min/max).</p>
<p>This type allows the frontend to generate a repeatable input block based on a template.</p>
<blockquote>
<p>[!NOTE]<br />
Inputs of type <code>layer</code> are not yet compatible with <strong>Dynamic Input Array</strong></p>
</blockquote>
<h4 id="dynamic-input-array-fields">Dynamic Input Array Fields:</h4>
<ul>
<li>
<p><strong><code>input_name</code></strong>: name of the input that will be displayed on the frontend GUI</p>
</li>
<li>
<p><strong><code>default_inputs_amount</code></strong>: occurences of the template input shown by default.</p>
</li>
<li>
<p><strong><code>minimum_inputs_amount</code></strong>: minimum number of inputs the user must provide.</p>
</li>
<li>
<p><strong><code>maximum_inputs_amount</code></strong>: maximum number of inputs the user can provide.</p>
</li>
<li>
<p><strong><code>input_parameter_name</code></strong>: used as the base key to retrieve the resulting array of values. All repeated inputs will share this key.</p>
</li>
<li>
<p><strong><code>input_priority</code></strong>: controls visibility category in the frontend (same as for regular inputs).</p>
</li>
<li>
<p><strong><code>input_template</code></strong>: CM input object used as the template for each item in the array.</p>
</li>
</ul>
<h4 id="example">Example</h4>
<pre><code>{
  &quot;input_name&quot;: &quot;Number of input occurrences&quot;,
  &quot;default_inputs_amount&quot;: 1,
  &quot;minimum_inputs_amount&quot;: 0,
  &quot;maximum_inputs_amount&quot;: 5,
  &quot;input_parameter_name&quot;: &quot;custom_multiplier&quot;,
  &quot;input_priority&quot;: 0,
  &quot;input_template&quot;: {
    &quot;input_name&quot;: &quot;Custom multiplier entry&quot;,
    &quot;input_type&quot;: &quot;input&quot;,
    &quot;input_description&quot;: &quot;User-defined multiplier from dynamic array.&quot;,
    &quot;input_parameter_name&quot;: &quot;custom_multiplier&quot;,
    &quot;input_value&quot;: 1,
    &quot;input_priority&quot;: 0,
    &quot;input_unit&quot;: &quot;&quot;,
    &quot;input_min&quot;: 0,
    &quot;input_max&quot;: 10,
    &quot;cm_id&quot;: 1
  }
}
</code></pre>
<p><img width="486" height="298" alt="image" src="https://github.com/user-attachments/assets/3d8bbc5b-917f-43fa-ad69-d0424f152920" /></p>
<h3 id="dynamic-input-options">Dynamic Input Options</h3>
<p>Used when the input tree changes based on the user's selection in a select or radio input.</p>
<ul>
<li>
<p>A parent input (e.g., Processing Path) defines multiple options (e.g., Path A, Path B).</p>
</li>
<li>
<p>Each option is linked to a set of child inputs, which are shown only if the option is selected.</p>
</li>
<li>
<p>These children can themselves include regular inputs, arrays, or nested options, creating hierarchical dynamic structures.</p>
</li>
</ul>
<h4 id="dynamic-input-options-fields">Dynamic Input Options Fields:</h4>
<ul>
<li>
<p><strong><code>input_name</code></strong>: name of the input that will be displayed on the frontend GUI</p>
</li>
<li>
<p><strong><code>input_priority</code></strong>: controls visibility category in the frontend (same as for regular inputs).</p>
</li>
<li>
<p><strong><code>parent_input</code></strong>: a regular input of type <code>select</code> or <code>radio</code></p>
</li>
<li>
<p><strong><code>~path_defined_in_parent_input~</code></strong>: An array of inputs that is displayed only when the corresponding value is selected in the parent input. There can be as many <code>~path_defined_in_parent_input~</code> as there are options in the parent input. The key must be an exact match to the parent input options. The inputs in this array can be regular inputs, dynamic input array or dynamic input options.</p>
</li>
</ul>
<blockquote>
<p>[!WARNING]<br />
When nesting dynamic input options into dynamic input options, you should:<br />
- Make sure a regular input cannot be displayed multiple times simultaneously.<br />
  If the hierarchy of dynamic input options can have different paths leading to the same regular input, ensure those paths cannot be used at the same time. Only the most recently changed value of the regular input will be received in the CM computation method. Ideally, avoid reusing regular inputs in multiple paths.<br />
- Avoid too many levels of nesting with dynamic input options.</p>
</blockquote>
<pre><code>    {
        &quot;input_name&quot;: &quot;Path-based dynamic children&quot;,
        &quot;input_priority&quot;: 0,
        &quot;parent_input&quot;: {
            &quot;input_name&quot;: &quot;Path selection&quot;,
            &quot;input_type&quot;: &quot;radio&quot;,
            &quot;input_description&quot;: &quot;Choose a processing path&quot;,
            &quot;input_parameter_name&quot;: &quot;path_selector&quot;,
            &quot;input_value&quot;: &quot;Path Alpha&quot;,
            &quot;input_options_array&quot;: [&quot;Path Alpha&quot;, &quot;Path Beta&quot;],
            &quot;input_priority&quot;: 0,
            &quot;input_unit&quot;: &quot;&quot;,
            &quot;input_min&quot;: &quot;&quot;,
            &quot;input_max&quot;: &quot;&quot;,
            &quot;cm_id&quot;: 1,
        },
        &quot;Path Alpha&quot;: [
            {
                &quot;input_name&quot;: &quot;Alpha Input A&quot;,
                &quot;input_type&quot;: &quot;input&quot;,
                &quot;input_description&quot;: &quot;First input for Path Alpha&quot;,
                &quot;input_parameter_name&quot;: &quot;alpha_input_a&quot;,
                &quot;input_value&quot;: 10,
                &quot;input_priority&quot;: 0,
                &quot;input_unit&quot;: &quot;units&quot;,
                &quot;input_min&quot;: 0,
                &quot;input_max&quot;: 100,
                &quot;cm_id&quot;: 1,
            },
            {
                &quot;input_name&quot;: &quot;Alpha Input B&quot;,
                &quot;input_type&quot;: &quot;range&quot;,
                &quot;input_description&quot;: &quot;Second input for Path Alpha&quot;,
                &quot;input_parameter_name&quot;: &quot;alpha_input_b&quot;,
                &quot;input_value&quot;: 50,
                &quot;input_priority&quot;: 0,
                &quot;input_unit&quot;: &quot;%&quot;,
                &quot;input_min&quot;: 0,
                &quot;input_max&quot;: 100,
                &quot;cm_id&quot;: 1,
            },
        ],
        &quot;Path Beta&quot;: [
            {
                &quot;input_name&quot;: &quot;Beta Input&quot;,
                &quot;input_type&quot;: &quot;input&quot;,
                &quot;input_description&quot;: &quot;Only input for Path Beta&quot;,
                &quot;input_parameter_name&quot;: &quot;beta_input&quot;,
                &quot;input_value&quot;: 5,
                &quot;input_priority&quot;: 0,
                &quot;input_unit&quot;: &quot;kWh&quot;,
                &quot;input_min&quot;: 0,
                &quot;input_max&quot;: 1000,
                &quot;cm_id&quot;: 1,
            }
        ],
    },
</code></pre>
<p><img width="484" height="328" alt="image" src="https://github.com/user-attachments/assets/e1bc51fc-fa1f-4bd9-b80f-147f0dceb7aa" />
<img width="486" height="329" alt="image" src="https://github.com/user-attachments/assets/07645c84-8ae2-42d6-a950-aa6f5bf6109a" /></p>
<blockquote>
<p>[!NOTE]<br />
Inputs of type <code>layer</code> can be used as the <code>parent_input</code> of a <strong>Dynamic Input Options</strong>. In this case, use the workspacenames of layers as the <code>input_options_array</code> and define the inputs needed for each layer by using the layer workspacename as the <code>~path_defined_in_parent_input~</code> key.</p>
</blockquote>
<p><strong><a href="#top">Go To Top</a></strong></p>
<h2 id="5-outputs">5. Outputs</h2>
<p>The Outputs are all the data that the CM will return to the be displayed in the Visualization Tool. Standards have been defined to ensure the frontend can display the data correctly. It can be found in <code>cm/app/api_v1/calculation_module.py</code>
All the outputs should be returned in the form of a dictionary named <code>result</code>. Find below an example:</p>
<pre><code>&quot;result&quot;:{
    &quot;name&quot;:&quot;CM - Scale heat and cool density maps&quot;,
    &quot;indicator&quot;:[...],
    &quot;graphics&quot;:[...],
    &quot;vector_layers&quot;:[...], 
    &quot;raster_layers&quot;:[...], 
    &quot;extra_zip_files&quot;:[...],
    &quot;csv_files&quot;:[...]
}
</code></pre>
<h3 id="name"><code>name</code></h3>
<p>Display name of the CM, shown in the frontend</p>
<h3 id="indicator"><code>indicator</code></h3>
<p>Array of indicators shown in the result panel. Each item in the array must have:</p>
<ul>
<li><strong><code>unit</code> (string):</strong> unit of the indicator</li>
<li><strong><code>name</code> (string):</strong> name of the indicator</li>
<li><strong><code>value</code> (number):</strong> value of the indicator</li>
</ul>
<pre><code class="language-python">&quot;indicator&quot;:[
    {
        &quot;unit&quot;:&quot;GWh/yr&quot;,
        &quot;name&quot;:&quot;Heat density total multiplied by 1.0&quot;,
        &quot;value&quot;:&quot;398.82725&quot;
    }, 
    {
        &quot;unit&quot;: &quot;&quot;, 
        &quot;name&quot;: &quot;Successful intervention strategy&quot;, 
        &quot;value&quot;: 'Feedback &amp; gamification through an App'
    }
],
</code></pre>
<p>Indicators result:</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/3ba83aea-f671-4bdd-9e68-a3185abddbb8" />
  <img alt="image" src="https://github.com/user-attachments/assets/5a1f08e7-cfa2-4f2d-bc9f-48d0b03f0258" /></p>
<h3 id="graphics"><code>graphics</code></h3>
<p>Array of graphs, each item in the array is contains the neccessary data to produce a chartjs graph. Find below the most common item to declare for a graph, for more detail refer to chartjs documentation:</p>
<ul>
<li>
<p><strong><code>type</code> (string) :</strong> type of the graphic that will be displayed. The possible types are <em>bar</em>, <em>line</em>, <em>radar</em>, <em>pie</em>, <em>polarArea</em>, <em>bubble</em>:</p>
<ul>
<li><strong>line:</strong> a line chart or line graph is a type of chart which displays information as a series of data points called 'markers' connected by a straight line segment:</li>
<li><strong>bar:</strong> a bar chart or bar graph is a chart or graph that presents categorical data with rectangular bars with heights or lengths proportional to the values that they represent:</li>
<li><strong>radar:</strong> a radar chart is a way of showing multiple data points and the variation between them:</li>
<li><strong>pie:</strong> a pie chart is divided into segments, the arc of each segment shows the proportional value of each piece of data:</li>
<li><strong>polarArea:</strong> polar area charts are similar to pie charts, but each segment has the same angle - the radius of the segment differs depending on the value:</li>
</ul>
</li>
<li>
<p><b style="color: red;">deprecated</b> <strong><code>xLabel</code>:</strong> This attribute is not supported by chartjs anymore, to define the text displayed on x-axis, use the new syntax</p>
</li>
<li><b style="color: red;">deprecated</b> <strong><code>yLabel</code>:</strong> This attribute is not supported by chartjs anymore, to define the text displayed on y-axis, use the new syntax
    New syntax to specify axis names. (do not add to pie diagrams or it will add axis lines):
New axis label syntax:  </li>
</ul>
<pre><code class="language-python">    &quot;options&quot;: {
        &quot;scales&quot;: {
            &quot;x&quot;: {
                &quot;title&quot;: {
                    &quot;display&quot;: True,
                    &quot;text&quot;:&quot;x axis name&quot;
                }
            },
            &quot;y&quot;: {
                &quot;title&quot;: {
                &quot;display&quot;: True,
                &quot;text&quot;:&quot;y axis name&quot;
            }
        }
    }
</code></pre>
<ul>
<li>
<p><strong>data:</strong> contains labels and datasets</p>
<ul>
<li><strong>labels (string[]) :</strong> x axis labels only x axis.</li>
<li><strong>datasets (array):</strong> set of data with its configuration</li>
<li><strong>label (string) :</strong> serie's label</li>
<li><strong>backgroundColor (string[]) :</strong> background color of each value to display</li>
<li><strong>data (number[]) :</strong> values of the serie</li>
</ul>
</li>
<li>
<p><strong><code>options</code>:</strong> options available to handle the charts, learn more at <a href="https://www.chartjs.org/docs/latest/charts/line.html">https://www.chartjs.org/docs/latest/charts/line.html</a>, /!\ chartjs example are in JavaScript and should be adapted to Python syntax</p>
</li>
</ul>
<p><b>All chart types and code example in page <a href="https://citiwatts.github.io/wiki/example-of-charts/">Example of Charts</a></b><br />
  Basic implementation :</p>
<pre><code class="language-python">  graphics = []
  graphics.append(
    {
      &quot;type&quot;: &quot;bar&quot;,
      &quot;data&quot;: {
        &quot;labels&quot;: [&quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, &quot;Friday&quot;, &quot;Saturday&quot;, &quot;Sunday&quot;],
        &quot;datasets&quot;: [
          {
            &quot;label&quot;: &quot;Temperature (C)&quot;,
            &quot;data&quot;: [12, 15, 14, 17, 20, 22, 19],
            &quot;backgroundColor&quot;: &quot;#4169E1&quot;, #blue
            &quot;borderColor&quot;: &quot;#ff0000&quot;, #red
            &quot;borderWidth&quot;: 1
          }
        ]
      },
      &quot;options&quot;: {
        &quot;responsive&quot;: True,
        &quot;scales&quot;: {
          &quot;y&quot;: {
            &quot;beginAtZero&quot;: True
          }
        }
      }
    }
  )
  result = dict()
  result['graphics'] = graphics
</code></pre>
<p><img alt="image" src="https://github.com/user-attachments/assets/9a9f1fe5-be1c-4e35-9aa0-011b0c6ee519" /></p>
<h3 id="vector_layers"><code>vector_layers</code></h3>
<ul>
<li><strong><code>name</code> (string):</strong> Should include "shapefile", name to be displayed on the frontend</li>
<li><strong><code>path</code> (string):</strong> path generated for the geotif file</li>
<li><strong><code>type</code> (string):</strong> type of the layer generated for symbology (legend). If set as custom, <code>symbology</code> must be defined. This case is useful for dynamic legends.</li>
<li><strong><code>symbology</code> (array):</strong>legend used for a layer of type<code>custom</code>, the symbology defines how the layer will be displayed in the frontend. It only is applied if the type is<code>custom</code>. It should not be defined if the type is not <code>custom</code>. The symbology should contain at least two elements including a case for the value 0 (or the lowest value that should not show on the map), and an opacity of 0, to avoid unwanted visual artifacts.</li>
</ul>
<pre><code class="language-python">[
    {
        &quot;name&quot;: &quot;shapefile of coherent areas with their potential&quot;, 
        &quot;path&quot;: output_shp1 
    },
    {
        &quot;name&quot;: &quot;District Cooling areas and there potentials - shapefile&quot;, 
        &quot;path&quot;: output_shp2, 
        &quot;type&quot;: &quot;custom&quot;,
        &quot;symbology&quot;: [
            {&quot;red&quot;: 254, &quot;green&quot;: 237, &quot;blue&quot;: 222, &quot;opacity&quot;: 0.5, &quot;value&quot;: symbol_vals_str[0], &quot;label&quot;: symbol_vals_str[0] + &quot; GWh&quot;},
            {&quot;red&quot;: 253, &quot;green&quot;: 208, &quot;blue&quot;: 162, &quot;opacity&quot;: 0.5, &quot;value&quot;: symbol_vals_str[1], &quot;label&quot;: symbol_vals_str[1] + &quot; GWh&quot;},
            {&quot;red&quot;: 253, &quot;green&quot;: 174, &quot;blue&quot;: 107, &quot;opacity&quot;: 0.5, &quot;value&quot;: symbol_vals_str[2], &quot;label&quot;: symbol_vals_str[2] + &quot; GWh&quot;},
            {&quot;red&quot;: 253, &quot;green&quot;: 141, &quot;blue&quot;: 60, &quot;opacity&quot;: 0.5, &quot;value&quot;: symbol_vals_str[3], &quot;label&quot;: symbol_vals_str[3] + &quot; GWh&quot;},
            {&quot;red&quot;: 230, &quot;green&quot;: 85, &quot;blue&quot;: 13, &quot;opacity&quot;: 0.5, &quot;value&quot;: symbol_vals_str[4], &quot;label&quot;: symbol_vals_str[4] + &quot; GWh&quot;},
            {&quot;red&quot;: 166, &quot;green&quot;: 54, &quot;blue&quot;: 3, &quot;opacity&quot;: 0.5, &quot;value&quot;: str(float(symbol_vals_str[4]) + step), &quot;label&quot;: &quot;&gt;&quot; + symbol_vals_str[4] + &quot; GWh&quot;}
        ]
    }
]
</code></pre>
<ul>
<li>vector layer default result (no defined <code>type:</code>):  </li>
</ul>
<p><img alt="image" src="https://github.com/user-attachments/assets/02f7ea95-1e4f-4a9c-a38f-95603d923495" /></p>
<ul>
<li>vector layer <code>custom</code> result:</li>
</ul>
<p><img alt="image" src="https://github.com/user-attachments/assets/6897045a-430d-4d00-9aa6-ef574ae1eaf4" /></p>
<h3 id="raster_layers"><code>raster_layers</code></h3>
<p>array of raster layers</p>
<ul>
<li><strong><code>name</code> (string):</strong> name to be displayed on the frontend</li>
<li><strong><code>path</code> (string):</strong> path generated for the geotif file</li>
<li><strong><code>type</code> (string):</strong> type of the layer generated for symbology (legend). If set as <code>custom</code>, <code>symbology</code> must be defined. This case is useful for dynamic legends.</li>
<li><strong><code>symbology</code> (array):</strong>legend used for a layer of type<code>custom</code>, the symbology defines how the layer will be displayed in the frontend. It only is applied if the type is<code>custom</code>. The symbology should contain at least two elements including a case for the value 0 (or the lowest value that should not show on the map), and an opacity of 0, to avoid unwanted visual artifacts.</li>
</ul>
<pre><code>&quot;type&quot;: &quot;custom&quot;,
&quot;symbology&quot;: [
  {&quot;red&quot;: 254, &quot;green&quot;: 237, &quot;blue&quot;: 222, &quot;opacity&quot;: 0, &quot;value&quot;: &quot;1&quot;, &quot;label&quot;: &quot;1 kWh/ha&quot;},
  {&quot;red&quot;: 253, &quot;green&quot;: 208, &quot;blue&quot;: 162, &quot;opacity&quot;: 0.8, &quot;value&quot;: &quot;100&quot;, &quot;label&quot;: &quot;100 kWh/ha&quot;},
  {&quot;red&quot;: 253, &quot;green&quot;: 174, &quot;blue&quot;: 107, &quot;opacity&quot;: 0.8, &quot;value&quot;: &quot;200&quot;, &quot;label&quot;: &quot;200 kWh/ha&quot;},
  {&quot;red&quot;: 253, &quot;green&quot;: 141, &quot;blue&quot;: 60, &quot;opacity&quot;: 0.8, &quot;value&quot;: &quot;400&quot;, &quot;label&quot;: &quot;400 kWh/ha&quot;},
  {&quot;red&quot;: 230, &quot;green&quot;: 85, &quot;blue&quot;: 13, &quot;opacity&quot;: 0.8, &quot;value&quot;: &quot;600&quot;, &quot;label&quot;: &quot;600 kWh/ha&quot;},
  {&quot;red&quot;: 166, &quot;green&quot;: 54, &quot;blue&quot;: 3, &quot;opacity&quot;: 0.8, &quot;value&quot;: &quot;800&quot;, &quot;label&quot;: &quot;800 kWh/ha&quot;}
]
</code></pre>
<ul>
<li><strong><code>layer</code> (string):</strong> type of the layer generated (for toolchaining in CM)</li>
</ul>
<p>In order to generate a path, developers should use the function <em>generate_output_file_tif()</em>, which needs the output directory as an argument. This function should be imported to the <code>calculation_module.py</code>. The path must be generated on the first lines of <em>calculation()</em> function found in <code>calculation_module.py</code>. This function For example:</p>
<pre><code class="language-python">    output_tif_1 = generate_output_file_tif(output_directory)
</code></pre>
<p>All the layers outputs must be retrieved and added to the <strong>raster_layers</strong> array after they have been generated by the calculation module provider functions.</p>
<pre><code class="language-python">[
    {
        &quot;name&quot;:&quot;layers of heat_density 1.0&quot;,
        &quot;path&quot;: output_raster1 
        &quot;type&quot;:&quot;heat&quot;,
        &quot;layer&quot;:&quot;heat_tot_curr_density&quot;
    },
    {
        &quot;name&quot;: &quot;layer of charging needs&quot;,
        &quot;path&quot;: output_raster2,
        &quot;type&quot;: &quot;custom&quot;,
        &quot;symbology&quot;: [
            {&quot;red&quot;: 254, &quot;green&quot;: 237, &quot;blue&quot;: 222, &quot;opacity&quot;: 0, &quot;value&quot;: &quot;1&quot;, &quot;label&quot;: &quot;&lt;1 kWh/ha&quot;},
            {&quot;red&quot;: 253, &quot;green&quot;: 208, &quot;blue&quot;: 162, &quot;opacity&quot;: 0.8, &quot;value&quot;: &quot;100&quot;, &quot;label&quot;: &quot;100 kWh/ha&quot;},
            {&quot;red&quot;: 253, &quot;green&quot;: 174, &quot;blue&quot;: 107, &quot;opacity&quot;: 0.8, &quot;value&quot;: &quot;200&quot;, &quot;label&quot;: &quot;200 kWh/ha&quot;},
            {&quot;red&quot;: 253, &quot;green&quot;: 141, &quot;blue&quot;: 60, &quot;opacity&quot;: 0.8, &quot;value&quot;: &quot;400&quot;, &quot;label&quot;: &quot;400 kWh/ha&quot;},
            {&quot;red&quot;: 230, &quot;green&quot;: 85, &quot;blue&quot;: 13, &quot;opacity&quot;: 0.8, &quot;value&quot;: &quot;600&quot;, &quot;label&quot;: &quot;600 kWh/ha&quot;},
            {&quot;red&quot;: 166, &quot;green&quot;: 54, &quot;blue&quot;: 3, &quot;opacity&quot;: 0.8, &quot;value&quot;: &quot;800&quot;, &quot;label&quot;: &quot;800 kWh/ha&quot;}]
     }
]
</code></pre>
<ul>
<li>raster <code>heat</code> result:</li>
</ul>
<p><img alt="image" src="https://github.com/user-attachments/assets/6fd84304-9915-4fbc-b9b8-a2ea6d0e60ac" /></p>
<ul>
<li>raster <code>custom</code> result:</li>
</ul>
<p><img alt="image" src="https://github.com/user-attachments/assets/ad4cb282-8c40-46d6-a270-dface3c515cf" /></p>
<h3 id="extra_zip_files"><code>extra_zip_files</code></h3>
<p>How to return a .zip file:</p>
<ol>
<li>Import the <code>create_extra_zip_file()</code> helper function:</li>
</ol>
<pre><code class="language-python">     # in calculation_module.py
     from ..helper import create_extra_zip_file
</code></pre>
<ol>
<li>
<p>Use the new helper function <code>create_extra_zip_file()</code> to create the <code>.zip</code> file to return:</p>
<p>The first parameter must be the output directory path. It is recommended to use <code>output_directory</code> that is accessible in the <code>calculation()</code> method of <code>calculation_module.py</code>.</p>
<p>Any other parameter should be a path to a file that must be added to the zip. There can be as many file path passed as parameters as needed. </p>
</li>
</ol>
<p>In calculation_module.py:</p>
<pre><code class="language-python">    def calculation(output_directory, inputs_raster_selection, inputs_parameter_selection):
        extra_output_files = create_extra_zip_file(output_directory, path_to_extra_file1, path_to_extra_file2)
</code></pre>
<ol>
<li>
<p>Add the <code>.zip</code> to the <code>result</code> dict:</p>
<p>use <code>"extra_zip_files"</code> as the key</p>
<p>The <code>.zip</code> must be added as an object in an array, meaning you could return multiple <code>.zip</code></p>
<p><code>[{"name": "name-shown-when-downloaded", "path": path-returned-by-create_extra_zip_file}]</code></p>
</li>
</ol>
<pre><code class="language-python">    # in calculation_module.py
    def calculation(output_directory, inputs_raster_selection, inputs_parameter_selection):
        extra_output_files = create_extra_zip_file(output_directory, path_to_extra_file1, path_to_extra_file2)
        result[&quot;extra_zip_files&quot;] = [{&quot;name&quot;: &quot;ComplementaryCSVandLogs&quot;, &quot;path&quot;: extra_output_files }]
</code></pre>
<h3 id="csv_files"><code>csv_files</code></h3>
<p>See below how to add .csv files to the outputs:</p>
<p>The <code>.csv</code> must be added as an object in an array, meaning you can return multiple <code>.csv</code></p>
<p><code>[{"name": "name-shown-when-downloaded", "path": path-to-csv-file}]</code></p>
<pre><code class="language-python">    # in calculation_module.py
    def calculation(output_directory, inputs_raster_selection, inputs_parameter_selection):
        result[&quot;csv_files&quot;] = [{&quot;name&quot;: &quot;ComplementaryCSV&quot;, &quot;path&quot;: path_to_complementary_csv }]
</code></pre>
<p><strong><a href="#top">Go To Top</a></strong></p>
<h2 id="6-logs">6. Logs</h2>
<p>Logs can help in the development process and for monitoring purposes.
To log from a CM, avoid using <code>print()</code>. The print statement is not always flushed and it may not appear in the log files. Instead use :</p>
<ul>
<li><code>logging.info("log")</code> (with <code>import logging</code>)</li>
<li><code>print("log", flush=True)</code></li>
</ul>
<p>examples:</p>
<pre><code class="language-python">    import logging
    logging.info(&quot;Log message&quot;)       #-&gt; 2025-01-02 08:59:55 [97] [INFO] Log message
    print(&quot;Log message&quot;, flush=True)  #-&gt; Log message
</code></pre>
<h3 id="access-logs-from-local-machine">Access Logs from local machine</h3>
<p>At <code>Visualization_tool\.dockerVolumes\logs\calculation_modules\base_calculation_module</code>, you can find the all the log files generated by the instance of the CM running on you local machine.<br />
At <code>.dockerVolumes\logs\calculation_modules\base_calculation_module\calculation_module_service.out.log</code>, you can find your logs defined as explained in this documentation.</p>
<p>Python syntax errors should also be logged in <code>.dockerVolumes\logs\calculation_modules\base_calculation_module\calculation_module_service.out.log</code>.</p>
<h3 id="access-logs-from-development-and-production">Access Logs from development and production</h3>
<p>To obtain access and information relating to the VPN, an email must be sent to <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#99;&#105;&#116;&#105;&#119;&#97;&#116;&#116;&#115;&#64;&#104;&#101;&#118;&#115;&#46;&#99;&#104;">&#99;&#105;&#116;&#105;&#119;&#97;&#116;&#116;&#115;&#64;&#104;&#101;&#118;&#115;&#46;&#99;&#104;</a>. The HES-SO Valais-Wallis IT department will then send an email to the requester with the information needed to download the VPN software and connection access. You will also receive a login from <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#99;&#105;&#116;&#105;&#119;&#97;&#116;&#116;&#115;&#64;&#104;&#101;&#118;&#115;&#46;&#99;&#104;">&#99;&#105;&#116;&#105;&#119;&#97;&#116;&#116;&#115;&#64;&#104;&#101;&#118;&#115;&#46;&#99;&#104;</a> to access the SFTP server containing the logs. We recommend using the filezilla client to access the contents of the SFTP server.</p>
<p>Once connected to the SFTP server, the user can view a folder by module calculation. Inside, there are 8 log files (calculation_module_service.err.log, calculation_module_service.out.log, consumer_cm_alive.err.log, consumer_cm_alive.out.log, consumer_cm_compute.err.log, consumer_cm_compute.out.log, register_cm.err.log, register_cm.out.log). It is within these files that the developers of calculation module will be able to find all the system logs.</p>
<p><strong><a href="#top">Go To Top</a></strong></p>
<h2 id="7-tests">7. Tests</h2>
<p>CM developers are encouraged to utilize Unit Tests to enhance the quality of their CM code. By identifying bugs early, ensuring expected functionality, and automating testing, Unit Tests streamline development. They also make refactoring safer, improve code structure, and simplify debugging.</p>
<h3 id="reminder">Reminder</h3>
<p>A unit test checks the smallest testable parts of an application (units) in isolation to ensure they work correctly. It is typically automated and focuses on individual functions, methods, or classes.</p>
<h3 id="writing-unit-tests">Writing Unit Tests</h3>
<p>The <code>base_calculation_module</code> already contains a <code>/tests</code> folder with a <code>tests.py</code> file that must be completed for each CM.</p>
<pre><code class="language-python">    class TestAPI(unittest.TestCase):
        def setUp(self):
            ...

        def tearDown(self):
            ...

        def test_compute(self):
            raster_file_path = 'tests/data/raster_for_test.tif'
            # simulate copy from HTAPI to CM
            save_path = UPLOAD_DIRECTORY+&quot;/raster_for_test.tif&quot;
            copyfile(raster_file_path, save_path)

            inputs_raster_selection = {}
            inputs_parameter_selection = {}
            inputs_vector_selection = {}
            inputs_raster_selection[&quot;layer_to_processs&quot;] = {
                &quot;path&quot;: save_path,
                &quot;workspacename&quot;: &quot;heat_tot_curr_density&quot;,
            }
            inputs_vector_selection[&quot;industrial_database_emissions&quot;] = ''
            inputs_parameter_selection[&quot;multiplication_factor&quot;] = 2

            # register the calculation module a
            payload = {&quot;inputs_raster_selection&quot;: inputs_raster_selection,
                   &quot;inputs_parameter_selection&quot;: inputs_parameter_selection,
                   &quot;inputs_vector_selection&quot;: inputs_vector_selection}

            rv, json = self.client.post('computation-module/compute/', data=payload)

            # Assert CM API has been called successfully
            self.assertTrue(rv.status_code == 200)
            ...
</code></pre>
<p>This file defines a class that subclasses <code>unittest.TestCase</code> and will be therefore discovered as Unit Test by the Python Unit Test Framework (<strong>unittest</strong>).</p>
<p>The <code>test_compute(self)</code> method triggers the communication route of the CM API in order to call the <code>calculation()</code> method explicitly defined per CM in <code>/cm/app/api_v1/calculation_module.py</code>. Depending on the calculation implemented, appropriate inputs must be set accordingly: <code>inputs_raster_selection</code>, <code>inputs_parameter_selection</code>, <code>inputs_parameter_selection</code>, <code>inputs_vector_selection</code>.</p>
<p><code>self.assertTrue(rv.status_code == 200</code> asserts that the CM API has been called successfully.</p>
<h3 id="enhance-unit-tests">Enhance Unit Tests</h3>
<p>More than only testing if the CM can be successfully called, CM developers are advised to deeply test their code.</p>
<p>This can be first realized by verifying the results of the <code>calculation()</code> method.</p>
<p>The last lines in <code>test_compute(self)</code> method assert that the calculated values correspond to the expected values. Each section of the results are compared individually:</p>
<pre><code class="language-python">    # Assert result is correct
    expected_result = {
        'name': 'CM - Scale heat and cool density maps',
    'indicator': [
        {&quot;unit&quot;: &quot;GWh/yr&quot;, &quot;name&quot;: &quot;Heat density total multiplied by  2.0&quot;, &quot;value&quot;: '14070.01'}
    ],
    'graphics': [],
    'vector_layers': [],
    'raster_layers': [{&quot;name&quot;: &quot;layers of heat_density 2.0&quot;, &quot;path&quot;: 'dummy_output.tif', &quot;type&quot;: &quot;heat&quot;, &quot;layer&quot;: &quot;heat_tot_curr_density&quot;}]
    }
    result = json['result']
    self.assertEqual(result['indicator'], expected_result['indicator'])
    self.assertEqual(result['name'], expected_result['name'])
    self.assertEqual(result['indicator'][0]['unit'], expected_result['indicator'][0]['unit'])
    self.assertEqual(result['indicator'][0]['name'], expected_result['indicator'][0]['name'])
    self.assertEqual(result['indicator'][0]['value'], expected_result['indicator'][0]['value'])
    self.assertEqual(result['raster_layers'][0]['name'], expected_result['raster_layers'][0]['name'])
    self.assertEqual(result['raster_layers'][0]['type'], expected_result['raster_layers'][0]['type'])
    self.assertEqual(result['raster_layers'][0]['layer'], expected_result['raster_layers'][0]['layer'])
</code></pre>
<p>Comparisons rely on the given inputs, so testing multiple inputs is essential to cover a wide range of scenarios.</p>
<h3 id="cover-different-scenarios">Cover different scenarios</h3>
<p>CM developers are encouraged to create multiple <code>test_*</code> methods in <code>tests.py</code> file to cover individually different scenarios. These scenarios can be identified as the edge cases that the CM must support.</p>
<p>Additional <code>test_*</code> methods should verify that:
* Results vary accordingly to the inputs provided
* Outputs files correspond to the expectations (quantity, name, path, content, ...)
* Exceptions should be raised when necessary (type, message, ...)</p>
<h3 id="run-unit-tests">Run Unit Tests</h3>
<p>Unit Tests run inside a container.</p>
<p>From the CM root folder (containing <code>docker-compose.tests.yml</code> file), CM developers can run Unit Test with following command:
<code>docker-compose -f docker-compose.tests.yml up --build --force-recreate</code></p>
<p><img alt="OK" src="https://github.com/user-attachments/assets/fb9ba9a7-f6bc-4ad4-bfd0-ec69da733834" /></p>
<p>In this case, <code>1</code> test has been run and <code>OK</code> statement confirm that everything ran correctly. </p>
<p>In case of errors, CM developers are quickly informed that some tests have failed. </p>
<p><img alt="KO" src="https://github.com/user-attachments/assets/5ae8e0ff-c715-46a4-9404-940cbbc3092d" /></p>
<p>Stack trace is provided to indicate in which file (i.e. <code>calculation_module.py</code>) and where (i.e. <code>line 46</code>) error happened. </p>
<h3 id="automated-testing">Automated testing</h3>
<p>Unit Tests are run by our CI/CD infrastructure. The Jenkins file located in every CM root folder calls the <code>docker-compose -f docker-compose.tests.yml</code> command on every commit made in CM repository. </p>
<p><strong><a href="#top">Go To Top</a></strong></p>
<h2 id="references">References</h2>
<p><strong><a href="#top">Go To Top</a></strong></p>
<h2 id="how-to-cite">How To Cite</h2>
<p><strong><a href="#top">Go To Top</a></strong></p>
<h2 id="authors-and-reviewers">Authors And Reviewers</h2>
<p>This page was written by the citiwatts Team and namely by:</p>
<p><a href="https://www.hevs.ch/easilab">EASILab - HES-SO</a>: David Gianadda, Gwenalle Gustin, Jrmie Vanin, Alain Duc</p>
<p><strong><a href="#top">Go To Top</a></strong></p>
<h2 id="license">License</h2>
<p><strong><a href="#top">Go To Top</a></strong></p>
<h2 id="acknowledgement">Acknowledgement</h2>
<p><strong><a href="#top">Go To Top</a></strong></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../how-to-edit-this-wiki/" class="md-footer__link md-footer__link--prev" aria-label="Previous: How To Edit This Wiki">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                How To Edit This Wiki
              </div>
            </div>
          </a>
        
        
          
          <a href="../api/" class="md-footer__link md-footer__link--next" aria-label="Next: API">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                API
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/citiwatts/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.action.edit", "navigation.top", "navigation.footer"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>